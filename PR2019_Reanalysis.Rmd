---
title: "PR2019 Re-analysis"
output: html_notebook
---

Re-compiled datasets and re-analyzed to ensure that results are consistent. Created R sheets with all variables at consistent depths. Notes for how depths were combined in master sheet. 

```{r global_options, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

# Packages
```{r Packages}
library(tidyverse)
library(car)
library(reshape2)
library(naniar)
library(agricolae)
```

# Datasets
```{r}
pasecore <- read.csv("~/Documents/Stats/PR2019/PaseCore_R.csv", header = TRUE, stringsAsFactors = TRUE, na.strings = "NA")
shortcore <- read.csv("~/Documents/Stats/PR2019/ShortCore_R.csv", header = TRUE, stringsAsFactors = TRUE, na.strings = "NA")

mytheme <- (theme_bw(base_size = 14)) + theme(panel.grid = element_blank(), 
                                              aspect.ratio = 1,
                                              axis.text = element_text(colour = "black"))
```

# Testing Outliers
## Soil Phosphatase Core
```{r BD}
# outlier test: Cook's D
mod <- lm(BulkDens ~ Site*Depth, data = pasecore)
cooksd <- cooks.distance(mod)

# plot Cook's D using 4/n
plot(cooksd, pch = "*", cex = 2, main = "Influential Obs by Cooks distance")
abline(h = 4/70, col="red")
text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd>4/70, names(cooksd),""), col="red")

# replacing 67 (ICAV Location 3 0-5cm 1.048)
pasecore <- pasecore %>%
  replace_with_na(replace = list(BulkDens = 1.048))
```
```{r ResinP}
# outlier test: Cook's D
mod <- lm(ResinP ~ Site*Depth, data = pasecore)
cooksd <- cooks.distance(mod)

# plot Cook's D using 4/n
plot(cooksd, pch = "*", cex = 2, main = "Influential Obs by Cooks distance")
abline(h = 4/70, col="red")
text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd>4/70, names(cooksd),""), col="red")

# replacing 19 (EVV Location 1 0-5cm = 114.269)
pasecore <- pasecore %>%
  replace_with_na(replace = list(ResinP = 114.269))
```
```{r Total OP}
# outlier test: Cook's D
mod <- lm(Total_OrgP ~ Site*Depth, data = pasecore)
cooksd <- cooks.distance(mod)

# plot Cook's D using 4/n
plot(cooksd, pch = "*", cex = 2, main = "Influential Obs by Cooks distance")
abline(h = 4/70, col="red")
text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd>4/70, names(cooksd),""), col="red")

# replacing 24 (EVV Location 1 80-90cm = 0.358)
pasecore <- pasecore %>%
  replace_with_na(replace = list(Total_OrgP = 0.358))
```
```{r Soil Pase}
# outlier test: Cook's D
mod <- lm(SoilPase_vol ~ Site*Depth, data = pasecore)
cooksd <- cooks.distance(mod)

# plot Cook's D using 4/n
plot(cooksd, pch = "*", cex = 2, main = "Influential Obs by Cooks distance")
abline(h = 4/70, col="red")
text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd>4/70, names(cooksd),""), col="red")

# replacing 4 o both SoilPase_g and SoilPase_vol (EVR Location 1 25-30cm = 13.987 / 15.245)
pasecore <- pasecore %>%
  replace_with_na(replace = list(SoilPase_g = 13.987)) %>% 
  replace_with_na(replace = list(SoilPase_vol = 15.245))
View(pasecore)
```
```{r Coarse Root}
# outlier test: Cook's D
mod <- lm(CoarseRootDensity ~ Site*Depth, data = pasecore)
cooksd <- cooks.distance(mod)

# plot Cook's D using 4/n
plot(cooksd, pch = "*", cex = 2, main = "Influential Obs by Cooks distance")
abline(h = 4/70, col="red")
text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd>4/70, names(cooksd),""), col="red")

# replacing 61 (ICA-V Location 2 0-5 cm = 4.296)
pasecore <- pasecore %>%
  replace_with_na(replace = list(CoarseRootDensity = 4.296))
View(pasecore)
```
```{r Fine Root}
# outlier test: Cook's D
mod <- lm(FineRootDensity ~ Site*Depth, data = pasecore)
cooksd <- cooks.distance(mod)

# plot Cook's D using 4/n
plot(cooksd, pch = "*", cex = 2, main = "Influential Obs by Cooks distance")
abline(h = 4/70, col="red")
text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd>4/70, names(cooksd),""), col="red")

# replacing 44 (ICA-R Location 2 7-12 cm = 0.617)
pasecore <- pasecore %>%
  replace_with_na(replace = list(FineRootDensity = 0.617))
```

## Short Core
```{r Short BD}
# outlier test: Cook's D
mod <- lm(BulkDensity ~ Site*Depth, data = shortcore)
cooksd <- cooks.distance(mod)

# plot Cook's D using 4/n
plot(cooksd, pch = "*", cex = 2, main = "Influential Obs by Cooks distance")
abline(h = 4/70, col="red")
text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd>4/70, names(cooksd),""), col="red")

# replacing 34 (ICAV Location 3 0-10cm 0.914)
shortcore <- shortcore %>%
  replace_with_na(replace = list(BulkDensity = 0.914))
```
```{r Short ResinP}
# outlier test: Cook's D
mod <- lm(ResinP ~ Site*Depth, data = shortcore)
cooksd <- cooks.distance(mod)

# plot Cook's D using 4/n
plot(cooksd, pch = "*", cex = 2, main = "Influential Obs by Cooks distance")
abline(h = 4/70, col="red")
text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd>4/70, names(cooksd),""), col="red")

# replacing 10 (EVV Location 1 10-20cm = 63.39500)
shortcore <- shortcore %>%
  replace_with_na(replace = list(ResinP = 63.39500))
```
```{r Short Total OP}
# outlier test: Cook's D
mod <- lm(Total_OrgP ~ Site*Depth, data = shortcore)
cooksd <- cooks.distance(mod)

# plot Cook's D using 4/n
plot(cooksd, pch = "*", cex = 2, main = "Influential Obs by Cooks distance")
abline(h = 4/70, col="red")
text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd>4/70, names(cooksd),""), col="red")

# replacing 11, 12 (EVV Location 1 10-20 cm = 0.31800 / EVV Location 1 20-30 cm = 0.27700)
shortcore <- shortcore %>%
  replace_with_na(replace = list(Total_OrgP = 0.31800)) %>% 
  replace_with_na(replace = list(Total_OrgP = 0.27700))
```
```{r Short Soil Pase}
# outlier test: Cook's D
mod <- lm(SoilPase_g ~ Site*Depth, data = shortcore)
cooksd <- cooks.distance(mod)

# plot Cook's D using 4/n
plot(cooksd, pch = "*", cex = 2, main = "Influential Obs by Cooks distance")
abline(h = 4/70, col="red")
text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd>4/70, names(cooksd),""), col="red")

# replacing 9 SoilPase_vol (EVR Location 3 20-30cm = 10.986) and 9 on SoilPase_g (10.931)
shortcore <- shortcore %>%
  replace_with_na(replace = list(SoilPase_g = 10.931)) %>% 
  replace_with_na(replace = list(SoilPase_vol = 10.986))
```
```{r Short Fine Root}
# outlier test: Cook's D
mod <- lm(FineRootDensity ~ Site*Depth, data = shortcore)
cooksd <- cooks.distance(mod)

# plot Cook's D using 4/n
plot(cooksd, pch = "*", cex = 2, main = "Influential Obs by Cooks distance")
abline(h = 4/70, col="red")
text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd>4/70, names(cooksd),""), col="red")

# replacing 22 (ICA-R Location 2 0-10 cm = 0.897)
shortcore <- shortcore %>%
  replace_with_na(replace = list(FineRootDensity = 0.897))
```
```{r Short SA}
# outlier test: Cook's D
mod <- lm(RootSurfaceArea ~ Site*Depth, data = shortcore)
cooksd <- cooks.distance(mod)

# plot Cook's D using 4/n
plot(cooksd, pch = "*", cex = 2, main = "Influential Obs by Cooks distance")
abline(h = 4/70, col="red")
text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd>4/70, names(cooksd),""), col="red")

# replacing 19 (ICA-R Location 1 0-10 cm = 75.78)
shortcore <- shortcore %>%
  replace_with_na(replace = list(RootSurfaceArea = 75.78))
```
```{r Short Root Pase}
# outlier test: Cook's D
mod <- lm(RootPase_vol ~ Site*Depth, data = shortcore)
cooksd <- cooks.distance(mod)

# plot Cook's D using 4/n
plot(cooksd, pch = "*", cex = 2, main = "Influential Obs by Cooks distance")
abline(h = 4/70, col="red")
text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd>4/70, names(cooksd),""), col="red")

# replacing 24 (ICA-R Location 2 20-30 cm = 167.288) / 22 ICAR 2 0-10 = 0.065
shortcore <- shortcore %>%
  replace_with_na(replace = list(RootPase_groot = 167.288)) %>% 
  replace_with_na(replace = list(RootPase_vol = 0.065))
```

# Testing Normality and Variance
```{r Soil Pase Core}
# Bulk Density
qqPlot(pasecore$BulkDens)
shapiro.test(pasecore$BulkDens) # normal
leveneTest(BulkDens ~ Site*Depth, data = pasecore) # good 

# Resin P
qqPlot(pasecore$ResinP)
shapiro.test(pasecore$ResinP)  # not normal
leveneTest(ResinP ~ Site*Depth, data = pasecore)  # good

# Total_OrgP
qqPlot(pasecore$Total_OrgP)
shapiro.test(pasecore$Total_OrgP) # not normal
leveneTest(Total_OrgP ~ Site*Depth, data = pasecore) # good

# Percent P 
qqPlot(pasecore$PercentP)
shapiro.test(pasecore$PercentP) # normal
leveneTest(PercentP ~ Site*Depth, data = pasecore) # good

# Soil Pase (g)
qqPlot(pasecore$SoilPase_g)
shapiro.test(pasecore$SoilPase_g) # not normal
leveneTest(SoilPase_g ~ Site*Depth, data = pasecore) # good

# Soil Pase (vol)
qqPlot(pasecore$SoilPase_vol)
shapiro.test(pasecore$SoilPase_vol) # not normal
leveneTest(SoilPase_vol ~ Site*Depth, data = pasecore) # not good. definitely use non-parametric

# Coarse Root Density
qqPlot(pasecore$CoarseRootDensity)
shapiro.test(pasecore$CoarseRootDensity) # not normal
leveneTest(CoarseRootDensity ~ Site*Depth, data = pasecore) # good

# Fine Root Density
qqPlot(pasecore$FineRootDensity)
shapiro.test(pasecore$FineRootDensity) # not normal
leveneTest(FineRootDensity ~ Site*Depth, data = pasecore) # good
```

```{r Short Core}

# Root Pase
qqPlot(shortcore$RootPase_groot)
shapiro.test(shortcore$RootPase_groot) # not normal
leveneTest(RootPase_groot ~ Site*Depth, data = shortcore) # variance ok

# Coarse Root Density
qqPlot(shortcore$CoarseRootDensity)
shapiro.test(shortcore$CoarseRootDensity) # not normal
leveneTest(CoarseRootDensity ~ Site*Depth, data = shortcore) # good

# Fine Root Density
qqPlot(shortcore$FineRootDensity)
shapiro.test(shortcore$FineRootDensity) # not normal
leveneTest(FineRootDensity ~ Site*Depth, data = shortcore) # variance ok

# Root Pase vol
qqPlot(shortcore$RootPase_vol)
shapiro.test(shortcore$RootPase_vol) # not normal
leveneTest(RootPase_vol ~ Site*Depth, data = shortcore) # not good

# Root Surface Area
qqPlot(shortcore$RootSurfaceArea)
shapiro.test(shortcore$RootSurfaceArea) # normal
leveneTest(RootSurfaceArea ~ Site*Depth, data = shortcore) # variance ok

# Bulk Density
qqPlot(shortcore$BulkDensity)
shapiro.test(shortcore$BulkDensity) # normal
leveneTest(BulkDensity ~ Site*Depth, data = shortcore) # good 

# Resin P
qqPlot(shortcore$ResinP)
shapiro.test(shortcore$ResinP)  # not normal
leveneTest(ResinP ~ Site*Depth, data = shortcore)  # variance ok

# Total_OrgP
qqPlot(shortcore$Total_OrgP)
shapiro.test(shortcore$Total_OrgP) # not normal
leveneTest(Total_OrgP ~ Site*Depth, data = shortcore) # good

# Percent P 
qqPlot(shortcore$PercentP)
shapiro.test(shortcore$PercentP) # normal
leveneTest(PercentP ~ Site*Depth, data = shortcore) # good

# Soil Pase (g)
qqPlot(shortcore$SoilPase_g)
shapiro.test(shortcore$SoilPase_g) # normal
leveneTest(SoilPase_g ~ Site*Depth, data = shortcore) # good

# Soil Pase (vol)
qqPlot(shortcore$SoilPase_vol)
shapiro.test(shortcore$SoilPase_vol) # not normal
leveneTest(SoilPase_vol ~ Site*Depth, data = shortcore) # variance ok


```



# Soil Phosphatase Core
## Summaries and ANOVAs
```{r BD Summary}

# boxplot
pasecore$Depth = factor(pasecore$Depth, levels = c('0-5cm', '7-12cm', '15-20cm', '25-30cm', '45-50cm', '80-90cm'))
ggplot(data = pasecore, aes(x = Depth, y = BulkDens)) + geom_boxplot(aes(fill = Site)) + mytheme +
  theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1))

# mean, sd, se: site x depth
bulkdens.sum <- pasecore %>%
  dplyr::group_by(Site, Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(BulkDens, na.rm = TRUE),
            sd = sd(BulkDens, na.rm = TRUE),
            se = ((sd(BulkDens, na.rm = TRUE))/sqrt(n())))

bulkdens.sum$Depth = factor(bulkdens.sum$Depth, levels = c('0-5cm', '7-12cm', '15-20cm', '25-30cm', '45-50cm', '80-90cm'))
ggplot(data = bulkdens.sum, aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  facet_grid(.~Site) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Bulk~Density))

# point
pd <- position_dodge(0.1) # moves them 0.05 to the left and right

ggplot(data = bulkdens.sum, aes(x = Depth, y = mean, colour = Site, group = Site)) + 
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), width = 0.2, position = pd) +
  geom_line(position = pd) +
  geom_point(position = pd, alpha = 0.5, size = 3) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Bulk~Density))

# mean, sd, se: site 
bulkdens.sum2 <- pasecore %>%
  dplyr::group_by(Site) %>%
  dplyr::summarise(n = n(),
            mean = mean(BulkDens, na.rm = TRUE),
            sd = sd(BulkDens, na.rm = TRUE),
            se = ((sd(BulkDens, na.rm = TRUE))/sqrt(n())))

ggplot(data = bulkdens.sum2, aes(x = Site, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Bulk~Density)) +
  theme(axis.title.x = element_blank())
```
```{r BD ANOVA}
# normal data, variance good
pase.bd.aov <- aov(BulkDens ~ Site + Depth + Site:Depth, data = pasecore)
summary(pase.bd.aov) # no interaction so analyze separately

pase.bd.site <- aov(BulkDens ~ Site, data = pasecore)
summary(pase.bd.site)
TukeyHSD(pase.bd.site)

pase.bd.depth <- aov(BulkDens ~ Depth, data = pasecore)
summary(pase.bd.depth)
TukeyHSD(pase.bd.depth)


# Depth letters
model <- lm(BulkDens ~ Depth, data = pasecore)
bd.depth <- HSD.test(model, "Depth", group = TRUE, alpha = 0.05)
print(bd.depth)


```

```{r Organic P Summary}
# boxplot
pasecore$Depth = factor(pasecore$Depth, levels = c('0-5cm', '7-12cm', '15-20cm', '25-30cm', '45-50cm', '80-90cm'))
ggplot(data = pasecore, aes(x = Depth, y = Total_OrgP)) + geom_boxplot() + facet_grid(.~Site) + mytheme +
  theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Total~Organic~P))

# mean, sd, se: site x depth
organicp.sum <- pasecore %>%
  dplyr::group_by(Site, Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(Total_OrgP, na.rm = TRUE),
            sd = sd(Total_OrgP, na.rm = TRUE),
            se = ((sd(Total_OrgP, na.rm = TRUE))/sqrt(n())))

organicp.sum$Depth = factor(organicp.sum$Depth, levels = c('0-5cm', '7-12cm', '15-20cm', '25-30cm', '45-50cm', '80-90cm'))
ggplot(data = organicp.sum, aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  facet_grid(.~Site) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Total~Organic~P))

# point
pd <- position_dodge(0.1) # moves them 0.05 to the left and right

ggplot(data = organicp.sum, aes(x = Depth, y = mean, colour = Site, group = Site)) + 
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), width = 0.2, position = pd) +
  geom_line(position = pd) +
  geom_point(position = pd, alpha = 0.5, size = 3) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Total~Organic~P))

# mean, sd, se: site 
organicp.sum2 <- pasecore %>%
  dplyr::group_by(Site) %>%
  dplyr::summarise(n = n(),
            mean = mean(Total_OrgP, na.rm = TRUE),
            sd = sd(Total_OrgP, na.rm = TRUE),
            se = ((sd(Total_OrgP, na.rm = TRUE))/sqrt(n())))

ggplot(data = organicp.sum2, aes(x = Site, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Organic~P)) +
  theme(axis.title.x = element_blank())
```
```{r Organic P ANOVA}
# non-normal data, must transform
# variance ok

# rank transformation
rank.organicp <- rank(pasecore$Total_OrgP)
pasecore <- cbind(pasecore, rank.organicp)

# model
pase.organicp.aov <- lm(rank.organicp ~ Site + Depth + Site:Depth, data = pasecore)
anova(pase.organicp.aov) # no interaction analyze separately

organicp.site <- aov(rank.organicp ~ Site, data = pasecore)
summary(organicp.site)
TukeyHSD(organicp.site)


organicp.depth <- aov(rank.organicp ~ Depth, data = pasecore)
summary(organicp.depth)
TukeyHSD(organicp.depth)

# Site Letters. 
model <- lm(rank.organicp ~ Site, data = pasecore)
organicp.site <- HSD.test(model, "Site", group = TRUE, alpha = 0.05)
print(organicp.site)

# Depth letters
model <- lm(rank.organicp ~ Depth, data = pasecore)
organicp.depth <- HSD.test(model, "Depth", group = TRUE, alpha = 0.05)
print(organicp.depth) # no difference in depth
```

```{r Resin P Summary}

# boxplot
pasecore$Depth = factor(pasecore$Depth, levels = c('0-5cm', '7-12cm', '15-20cm', '25-30cm', '45-50cm', '80-90cm'))
ggplot(data = pasecore, aes(x = Depth, y = ResinP)) + geom_boxplot() + facet_grid(.~Site) + mytheme +
  theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Resin~P))

# mean, sd, se: site x depth
resinp.sum <- pasecore %>%
  dplyr::group_by(Site, Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(ResinP, na.rm = TRUE),
            sd = sd(ResinP, na.rm = TRUE),
            se = ((sd(ResinP, na.rm = TRUE))/sqrt(n())))

resinp.sum $Depth = factor(resinp.sum $Depth, levels = c('0-5cm', '7-12cm', '15-20cm', '25-30cm', '45-50cm', '80-90cm'))
ggplot(data = resinp.sum , aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  facet_grid(.~Site) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Resin~P))

# point
pd <- position_dodge(0.1) # moves them 0.05 to the left and right

ggplot(data = resinp.sum, aes(x = Depth, y = mean, colour = Site, group = Site)) + 
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), width = 0.2, position = pd, alpha = 0.5) +
  geom_line(position = pd) +
  geom_point(position = pd, alpha = 0.5, size = 3) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Resin~P))

# mean, sd, se: site 
resinp.sum2 <- pasecore %>%
  dplyr::group_by(Site) %>%
  dplyr::summarise(n = n(),
            mean = mean(ResinP, na.rm = TRUE),
            sd = sd(ResinP, na.rm = TRUE),
            se = ((sd(ResinP, na.rm = TRUE))/sqrt(n())))

ggplot(data = resinp.sum2, aes(x = Site, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Resin~P)) +
  theme(axis.title.x = element_blank())

```
```{r Resin P ANOVA}

# not normal. must transform
# variance ok

# rank transformation
rank.resinp <- rank(pasecore$ResinP)
pasecore <- cbind(pasecore, rank.resinp)

# model
resinp.aov <- lm(rank.resinp ~ Site + Depth + Site:Depth, data = pasecore)
anova(resinp.aov) # significant interaction 

# Site and Depth Letters
site.depth <- with(pasecore, interaction(Site, Depth))
resinp.mod <- lm(rank.resinp ~ site.depth, data = pasecore)
resinp.out <- HSD.test(resinp.mod, "site.depth", group = TRUE, alpha = 0.05)
print(resinp.out) # color code this

# Site Letters. Use this for when there is one factor
model <- lm(rank.resinp ~ Site, data = pasecore)
resinp.site <- HSD.test(model, "Site", group = TRUE, alpha = 0.05)
print(resinp.site)
```

```{r Coarse Root Summary}
# boxplot
pasecore$Depth = factor(pasecore$Depth, levels = c('0-5cm', '7-12cm', '15-20cm', '25-30cm', '45-50cm', '80-90cm'))
ggplot(data = pasecore, aes(x = Depth, y = CoarseRootDensity)) + geom_boxplot() + facet_grid(.~Site) + mytheme +
  theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Coarse~Root~Density))

# mean, sd, se: site x depth
coarseroot.sum <- pasecore %>%
  dplyr::group_by(Site, Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(CoarseRootDensity, na.rm = TRUE),
            sd = sd(CoarseRootDensity, na.rm = TRUE),
            se = ((sd(CoarseRootDensity, na.rm = TRUE))/sqrt(n())))

coarseroot.sum$Depth = factor(coarseroot.sum$Depth, levels = c('0-5cm', '7-12cm', '15-20cm', '25-30cm', '45-50cm', '80-90cm'))
ggplot(data = coarseroot.sum, aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  facet_grid(.~Site) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Coarse~Root~P))

# point
pd <- position_dodge(0.1) # moves them 0.05 to the left and right

ggplot(data = coarseroot.sum, aes(x = Depth, y = mean, colour = Site, group = Site)) + 
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), width = 0.2, position = pd, alpha = 0.5) +
  geom_line(position = pd) +
  geom_point(position = pd, alpha = 0.5, size = 3) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Coarse~Root))

# mean, sd, se: site 
coarseroot.sum2 <- pasecore %>%
  dplyr::group_by(Site) %>%
  dplyr::summarise(n = n(),
            mean = mean(CoarseRootDensity, na.rm = TRUE),
            sd = sd(CoarseRootDensity, na.rm = TRUE),
            se = ((sd(CoarseRootDensity, na.rm = TRUE))/sqrt(n())))

ggplot(data = coarseroot.sum2, aes(x = Site, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Coarse~Root)) +
  theme(axis.title.x = element_blank())
```
```{r Coarse Root ANOVA}
# not normal. must transform
# variance ok

# rank transformation
rank.coarse <- rank(pasecore$CoarseRootDensity)
pasecore <- cbind(pasecore, rank.coarse)

# model
coarse.aov <- lm(rank.coarse ~ Site + Depth + Site:Depth, data = pasecore)
anova(coarse.aov)

# Site Letters. Use this for when there is one factor
model <- lm(rank.coarse ~ Site, data = pasecore)
coarse.site <- HSD.test(model, "Site", group = TRUE, alpha = 0.05)
print(coarse.site)
```

```{r Fine Root Summary}
# boxplot
pasecore$Depth = factor(pasecore$Depth, levels = c('0-5cm', '7-12cm', '15-20cm', '25-30cm', '45-50cm', '80-90cm'))
ggplot(data = pasecore, aes(x = Depth, y = FineRootDensity)) + geom_boxplot() + facet_grid(.~Site) + mytheme +
  theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Fine~Root~Density))

# mean, sd, se: site x depth
fineroot.sum <- pasecore %>%
  dplyr::group_by(Site, Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(FineRootDensity, na.rm = TRUE),
            sd = sd(FineRootDensity, na.rm = TRUE),
            se = ((sd(FineRootDensity, na.rm = TRUE))/sqrt(n())))

fineroot.sum$Depth = factor(fineroot.sum$Depth, levels = c('0-5cm', '7-12cm', '15-20cm', '25-30cm', '45-50cm', '80-90cm'))
ggplot(data = fineroot.sum, aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  facet_grid(.~Site) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Fine~Root))

# point
pd <- position_dodge(0.1) # moves them 0.05 to the left and right

ggplot(data = fineroot.sum, aes(x = Depth, y = mean, colour = Site, group = Site)) + 
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), width = 0.2, position = pd, alpha = 0.5) +
  geom_line(position = pd) +
  geom_point(position = pd, alpha = 0.5, size = 3) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Fine~Root))

# mean, sd, se: site 
fineroot.sum2 <- pasecore %>%
  dplyr::group_by(Site) %>%
  dplyr::summarise(n = n(),
            mean = mean(FineRootDensity, na.rm = TRUE),
            sd = sd(FineRootDensity, na.rm = TRUE),
            se = ((sd(FineRootDensity, na.rm = TRUE))/sqrt(n())))

ggplot(data = fineroot.sum2, aes(x = Site, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Fine~Root)) +
  theme(axis.title.x = element_blank())
```
```{r Fine Root ANOVA}
# not normal. must transform
# variance ok

# rank transformation
rank.fine <- rank(pasecore$FineRootDensity)
pasecore <- cbind(pasecore, rank.fine)

# model
fineroot.aov <- lm(rank.fine ~ Site + Depth + Site:Depth, data = pasecore)
anova(fineroot.aov) # no interaction, analyze separately

# site
fineroot.site <- aov(rank.fine ~ Site, data = pasecore)
anova(fineroot.site) # not significant

# depth
fineroot.depth <- aov(rank.fine ~ Depth, data = pasecore)
anova(fineroot.depth) # not significant

# letters
model <- lm(rank.fine ~ Depth, data = pasecore)
fineroot.depth <- HSD.test(model, "Depth", group = TRUE, alpha = 0.05)
print(fineroot.depth)
```

```{r Texture Summary}

library(reshape2)
pase.texture <- pasecore %>% 
  select(Site, Depth, Sand, Clay, Silt)

# site x depth
pase.text.sum <- pase.texture %>% 
  group_by(Site, Depth) %>%
  summarise_all(funs(mean, sd))

pase.text.sum.melt <- pase.text.sum %>% 
  select(Site, Depth, Sand_mean, Clay_mean, Silt_mean)
pase.text.sum.melt <- melt(pase.text.sum.melt, id = c("Site", "Depth"))
View(pase.text.sum.melt)

ggplot(pase.text.sum.melt, aes(x = Depth, y = value, fill = variable)) + facet_grid(.~Site) +
  geom_bar(stat = "identity") + mytheme + theme(axis.text.x = element_text(angle = 30, vjust = 1, hjust = 1),
                                                axis.title = element_blank())

# site
pase.text.sum2 <- pase.texture %>%
  select(Site, Sand, Clay, Silt) %>% 
  group_by(Site) %>%
  summarise_each(funs(mean(., na.rm = TRUE)))

pase.text.sum.melt2 <- melt(pase.text.sum2, id = c("Site"))

ggplot(pase.text.sum.melt2, aes(x = Site, y = value, fill = variable)) +
  geom_bar(stat = "identity") + mytheme + theme(axis.title = element_blank())

# pattern holds across depths
```

```{r Root P Summary}
# boxplot
pasecore$Depth = factor(pasecore$Depth, levels = c('0-5cm', '7-12cm', '15-20cm', '25-30cm', '45-50cm', '80-90cm'))
ggplot(data = pasecore, aes(x = Depth, y = PercentP)) + geom_boxplot(aes(fill = Site)) + mytheme

# mean, sd, se: site x depth
percentp.sum <- pasecore %>%
  dplyr::group_by(Site, Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(PercentP, na.rm = TRUE),
            sd = sd(PercentP, na.rm = TRUE),
            se = ((sd(PercentP, na.rm = TRUE))/sqrt(n())))

percentp.sum$Depth = factor(percentp.sum$Depth, levels = c('0-5cm', '7-12cm', '15-20cm', '25-30cm', '45-50cm', '80-90cm'))
ggplot(data = percentp.sum, aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  facet_grid(.~Site) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Root~'%'~P))

# point
pd <- position_dodge(0.1) # moves them 0.05 to the left and right

ggplot(data = percentp.sum, aes(x = Depth, y = mean, colour = Site, group = Site)) + 
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), width = 0.2, position = pd, alpha = 0.5) +
  geom_line(position = pd) +
  geom_point(position = pd, alpha = 0.5, size = 3) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Root~'%'~P))

# mean, sd, se: site 
percentp.sum2 <- pasecore %>%
  dplyr::group_by(Site) %>%
  dplyr::summarise(n = n(),
            mean = mean(PercentP, na.rm = TRUE),
            sd = sd(PercentP, na.rm = TRUE),
            se = ((sd(PercentP, na.rm = TRUE))/sqrt(n())))

ggplot(data = percentp.sum2, aes(x = Site, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Root~'%'~P)) +
  theme(axis.title.x = element_blank())
```
```{r Root P ANOVA}
# normal data
# variance ok

# model
rootp.aov <- lm(PercentP ~ Site + Depth + Site:Depth, data = pasecore)
anova(fineroot.aov) # no interaction term, depth appears most significant

# site
rootp.site <- aov(PercentP ~ Site, data = pasecore)
anova(rootp.site)
TukeyHSD(rootp.site)

# depth
rootp.depth <- aov(PercentP ~ Depth, data = pasecore)
anova(rootp.depth)
TukeyHSD(rootp.depth)

# Use this for when there is one factor
model <- lm(PercentP ~ Site, data = pasecore)
percentp.site <- HSD.test(model, "Site", group = TRUE, alpha = 0.05)
print(percentp.site)

# Use this for when there is one factor
model2 <- lm(PercentP ~ Depth, data = pasecore)
percentp.Depth <- HSD.test(model2, "Depth", group = TRUE, alpha = 0.05)
print(percentp.Depth)
```

### Soil Pase 
```{r Soil Pase g Summary}

# boxplot
pasecore$Depth = factor(pasecore$Depth, levels = c('0-5cm', '7-12cm', '15-20cm', '25-30cm', '45-50cm', '80-90cm'))
ggplot(data = pasecore, aes(x = Depth, y = SoilPase_g)) + geom_boxplot(aes(fill = Site)) + mytheme

# mean, sd, se: site x depth
soilpase_g.sum <- pasecore %>%
  dplyr::group_by(Site, Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(SoilPase_g, na.rm = TRUE),
            sd = sd(SoilPase_g, na.rm = TRUE),
            se = ((sd(SoilPase_g, na.rm = TRUE))/sqrt(n())))

soilpase_g.sum$Depth = factor(soilpase_g.sum$Depth, levels = c('0-5cm', '7-12cm', '15-20cm', '25-30cm', '45-50cm', '80-90cm'))
ggplot(data = soilpase_g.sum, aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  facet_grid(.~Site) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Soil~Phosphatase))

# point
pd <- position_dodge(0.1) # moves them 0.05 to the left and right

ggplot(data = soilpase_g.sum, aes(x = Depth, y = mean, colour = Site, group = Site)) + 
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), width = 0.2, position = pd, alpha = 0.5) +
  geom_line(position = pd) +
  geom_point(position = pd, alpha = 0.5, size = 3) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Soil~Phosphatase))

# mean, sd, se: site 
soilpase_g.sum2 <- pasecore %>%
  dplyr::group_by(Site) %>%
  dplyr::summarise(n = n(),
            mean = mean(SoilPase_g, na.rm = TRUE),
            sd = sd(SoilPase_g, na.rm = TRUE),
            se = ((sd(SoilPase_g, na.rm = TRUE))/sqrt(n())))

ggplot(data = soilpase_g.sum2, aes(x = Site, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Soil~Phosphatase)) +
  theme(axis.title.x = element_blank())
```
```{r Soil Pase g ANOVA}
# not normal. must transform
# variance ok

# rank transform
rank.soilpase.g <- rank(pasecore$SoilPase_g)
pasecore <- cbind(pasecore, rank.soilpase.g)

# model
soilpase.aov <- lm(rank.soilpase.g ~ Site + Depth + Site:Depth, data = pasecore)
anova(soilpase.aov) # significant interaction term

# Site and Depth Letters
site.depth <- with(pasecore, interaction(Site, Depth))
soilpase.g.mod <- lm(rank.soilpase.g ~ site.depth, data = pasecore)
soilpase.g.out <- HSD.test(soilpase.g.mod, "site.depth", group = TRUE, alpha = 0.05)
print(soilpase.g.out)

# Site Letters. Use this for when there is one factor
model <- lm(rank.soilpase.g ~ Site, data = pasecore)
rank.soilpase.g.site <- HSD.test(model, "Site", group = TRUE, alpha = 0.05)
print(rank.soilpase.g.site)
```

```{r Soil Pase vol Summary}

# boxplot
pasecore$Depth = factor(pasecore$Depth, levels = c('0-5cm', '7-12cm', '15-20cm', '25-30cm', '45-50cm', '80-90cm'))
ggplot(data = pasecore, aes(x = Depth, y = SoilPase_vol)) + geom_boxplot(aes(fill = Site)) + mytheme

# mean, sd, se: site x depth
soilpase_vol.sum <- pasecore %>%
  dplyr::group_by(Site, Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(SoilPase_vol, na.rm = TRUE),
            sd = sd(SoilPase_vol, na.rm = TRUE),
            se = ((sd(SoilPase_vol, na.rm = TRUE))/sqrt(n())))

soilpase_vol.sum$Depth = factor(soilpase_vol.sum$Depth, levels = c('0-5cm', '7-12cm', '15-20cm', '25-30cm', '45-50cm', '80-90cm'))
ggplot(data = soilpase_vol.sum, aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  facet_grid(.~Site) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Soil~Phosphatase))

# point
pd <- position_dodge(0.1) # moves them 0.05 to the left and right

ggplot(data = soilpase_vol.sum, aes(x = Depth, y = mean, colour = Site, group = Site)) + 
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), width = 0.2, position = pd, alpha = 0.5) +
  geom_line(position = pd) +
  geom_point(position = pd, alpha = 0.5, size = 3) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Soil~Phosphatase))

# mean, sd, se: site 
soilpase_vol.sum2 <- pasecore %>%
  dplyr::group_by(Site) %>%
  dplyr::summarise(n = n(),
            mean = mean(SoilPase_vol, na.rm = TRUE),
            sd = sd(SoilPase_vol, na.rm = TRUE),
            se = ((sd(SoilPase_vol, na.rm = TRUE))/sqrt(n())))

ggplot(data = soilpase_vol.sum2, aes(x = Site, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Soil~Phosphatase)) +
  theme(axis.title.x = element_blank())
```
```{r Soil Pase vol ANOVA}
# not normal. must transform
# variance not good. definitely transform

# rank transform
rank.soilpase.vol <- rank(pasecore$SoilPase_vol)
pasecore <- cbind(pasecore, rank.soilpase.vol)

# model
soilpase.aov <- lm(rank.soilpase.vol ~ Site + Depth + Site:Depth, data = pasecore)
anova(soilpase.aov)

# Site and Depth Letters
site.depth <- with(pasecore, interaction(Site, Depth))
soilpase.vol.mod <- lm(rank.soilpase.vol ~ site.depth, data = pasecore)
soilpase.vol.out <- HSD.test(soilpase.vol.mod, "site.depth", group = TRUE, alpha = 0.05)
print(soilpase.vol.out)

# Site Letters. Use this for when there is one factor
model <- lm(rank.soilpase.vol ~ Site, data = pasecore)
rank.soilpase.vol.site <- HSD.test(model, "Site", group = TRUE, alpha = 0.05)
print(rank.soilpase.vol.site)
```


## Correlations
```{r Bulk Density}

# BD x Total Organic P - significant
ggplot(data = pasecore, aes(x = BulkDens, y = Total_OrgP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls1 <- lm(Total_OrgP ~ BulkDens, data = pasecore)
coef(ls1) # no need to center it because positive intercept
summary(ls1) # eq: y = 0.249 - 0.113x; p < 0.05; r2 = 0.068

# BD x Resin P
ggplot(data = pasecore, aes(x = BulkDens, y = ResinP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls2 <- lm(ResinP ~ BulkDens, data = pasecore)
coef(ls2) # no need to center it because positive intercept
summary(ls2) # eq: y = 7.035 - 1.520x; p = 0.593; r2 = 0.004

# BD x Percent P - significant
ggplot(data = pasecore, aes(x = BulkDens, y = PercentP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls3 <- lm(PercentP ~ BulkDens, data = pasecore)
coef(ls3) # no need to center it because positive intercept
summary(ls3) # eq: y = 0.071 - 0.027x; p < 0.05; r2 = 0.120

# Coarse Root
ggplot(data = pasecore, aes(x = BulkDens, y = CoarseRootDensity)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls4 <- lm(CoarseRootDensity ~ BulkDens, data = pasecore)
coef(ls4) # no need to center it because positive intercept
summary(ls4) # eq: y = 2.822 - 1.712x; p = 0.547; r2 = 0.006

# Fine Root - significant
ggplot(data = pasecore, aes(x = BulkDens, y = FineRootDensity)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls5 <- lm(FineRootDensity ~ BulkDens, data = pasecore)
coef(ls5) # no need to center it because positive intercept
summary(ls5) # eq: y = 1.518 - 1.246x; p < 0.05; r2 = 0.229
```

```{r Organic P}

# Total Organic P x Resin P - significant
ggplot(data = pasecore, aes(x = Total_OrgP, y = ResinP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls6 <- lm(ResinP ~ Total_OrgP, data = pasecore)
coef(ls6) # no need to center it because positive intercept
summary(ls6) # eq: y = 1.403 +28.015x; p < 0.05; r2 = 0.241

# Total Organic P x Percent P - significant
ggplot(data = pasecore, aes(x = Total_OrgP, y = PercentP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls7 <- lm(PercentP ~ Total_OrgP, data = pasecore)
coef(ls7) # no need to center it because positive intercept
summary(ls7) # eq: y = 0.030 + 0.122x; p < 0.05; r2 = 0.553

# Total Organic P x Coarse Root
ggplot(data = pasecore, aes(x = Total_OrgP, y = CoarseRootDensity)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls8 <- lm(CoarseRootDensity ~ Total_OrgP, data = pasecore)
coef(ls8) # no need to center it because positive intercept
summary(ls8) # eq: y = 2.690 - 6.488x; p = 0.360; r2 = 0.013

# Total Organic P x Fine Root
ggplot(data = pasecore, aes(x = Total_OrgP, y = FineRootDensity)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme +
  scale_y_continuous(limits = c(0, 1.5))

ls9 <- lm(FineRootDensity ~ Total_OrgP, data = pasecore)
coef(ls9) # no need to center it because positive intercept
summary(ls9) # eq: y = 0.354 - 0.963x; p = 0.189; r2 = 0.026
```

```{r Resin P}

# Resin P x Percent P - significant
ggplot(data = pasecore, aes(x = ResinP, y = PercentP)) + geom_point() + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls10 <- lm(PercentP ~ ResinP, data = pasecore)
coef(ls10 ) # no need to center it because positive intercept
summary(ls10 ) # eq: y = 0.040 + 0.002x; p < 0.05; r2 = 0.174

# Resin P x Coarse Root - significant but not really
ggplot(data = pasecore, aes(x = ResinP, y = CoarseRootDensity)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls11 <- lm(CoarseRootDensity ~ ResinP, data = pasecore)
coef(ls11 ) # no need to center it because positive intercept
summary(ls11 ) # eq: y = 1.887 - 0.040x; p < 0.05; r2 = 0.174

# Resin P x Fine Root
ggplot(data = pasecore, aes(x = ResinP, y = FineRootDensity)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls12 <- lm(FineRootDensity ~ ResinP, data = pasecore)
coef(ls12 ) # no need to center it because positive intercept
summary(ls12 ) # eq: y = 0.488 + 0.002x; p = 0.909; r2 = 0.00019
```

```{r Coarse & Fine Root}

# Coarse Root x Percent P
ggplot(data = pasecore, aes(x = CoarseRootDensity, y = PercentP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme 
# definitely not significant. no point doing lm

# Fine Root x Percent P
ggplot(data = pasecore, aes(x = FineRootDensity, y = PercentP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme 
# definitely not significant. no point doing lm

# Fine Root x Organic P
ggplot(data = pasecore, aes(x = FineRootDensity, y = Total_OrgP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme +
  scale_x_continuous(limits = c(0, 1.25))

ls9 <- lm(Total_OrgP ~ FineRootDensity, data = pasecore)
coef(ls9) # no need to center it because positive intercept
summary(ls9) # eq: y = 0.354 - 0.963x; p = 0.189; r2 = 0.026

```

```{r Soil Pase Correlations}

# BD x SoilPase - significant
ggplot(data = pasecore, aes(x = BulkDens, y = SoilPase_g)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme 

ls13 <- lm(SoilPase_g ~ BulkDens, data = pasecore)
coef(ls13 ) # no need to center it because positive intercept
summary(ls13) # eq: y = 13.302 - 10.716x; p < 0.05; r2 = 0.383

ggplot(data = pasecore, aes(x = BulkDens, y = SoilPase_vol)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme 

ls13b <- lm(SoilPase_vol ~ BulkDens, data = pasecore)
coef(ls13b ) # no need to center it because positive intercept
summary(ls13b) # eq: y = 6.218 - 3.646x; p < 0.05; r2 = 0.125

# Total Organic P x SoilPase - significant
ggplot(data = pasecore, aes(x = Total_OrgP, y = SoilPase_g)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme 

ls14 <- lm(SoilPase_g ~ Total_OrgP, data = pasecore)
coef(ls14) # no need to center it because positive intercept
summary(ls14) # eq: y = 1.667 + 19.488x; p < 0.05; r2 = 0.220

ggplot(data = pasecore, aes(x = Total_OrgP, y = SoilPase_vol)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme 

ls14b <- lm(SoilPase_vol ~ Total_OrgP, data = pasecore)
coef(ls14b) # no need to center it because positive intercept
summary(ls14b) # eq: y = 1.826 + 9.321x; p < 0.05; r2 = 0.158

# Resin P x Soil Pase
ggplot(data = pasecore, aes(x = SoilPase_g, y = ResinP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme + 
  scale_x_continuous(limits = c(0, 10))

ls15 <- lm(SoilPase_g ~ ResinP, data = pasecore)
coef(ls15) # no need to center it because positive intercept
summary(ls15) # eq: y = 3.958 + 0.119x; p = 0.218; r2 = 0.023

ggplot(data = pasecore, aes(x = ResinP, y = SoilPase_vol)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme 

ls15b <- lm(SoilPase_vol ~ ResinP, data = pasecore)
coef(ls15b) # no need to center it because positive intercept
summary(ls15b) # eq: y = 3.037 + 0.038x; p = 0.500; r2 = 0.007


# Fine Root x Soil Pase - significant
ggplot(data = pasecore, aes(x = FineRootDensity, y = SoilPase_g)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme  +
  scale_x_continuous(limits = c(0, 1.2))

ls16 <- lm(SoilPase_g ~ FineRootDensity, data = pasecore)
coef(ls16) # no need to center it because positive intercept
summary(ls16) # eq: y = 2.871 + 3.449x; p < 0.05; r2 = 0.247

ggplot(data = pasecore, aes(x = FineRootDensity, y = SoilPase_vol)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme +
  scale_x_continuous(limits = c(0, 1.2))

ls16b <- lm(SoilPase_vol ~ FineRootDensity, data = pasecore)
coef(ls16b) # no need to center it because positive intercept
summary(ls16b) # eq: y = 2.396 + 1.695x; p < 0.05; r2 = 0.181

# Soil Pase x Percent P  - significant
ggplot(data = pasecore, aes(x = SoilPase_g, y = PercentP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls35 <- lm(PercentP ~ SoilPase_g, data = pasecore)
coef(ls35) # no need to center it because positive intercept
summary(ls35) # eq: y = 0.041 + 0.002x; p < 0.05; r2 = 0.183

ggplot(data = pasecore, aes(x = SoilPase_vol, y = PercentP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme 

ls35b <- lm(PercentP ~ SoilPase_vol, data = pasecore)
coef(ls35b) # no need to center it because positive intercept
summary(ls35b) # eq: y = 0.041 + 0.003x; p = 0.500; r2 = 0.121
```

# Paired Phosphatase Core
## Summaries
```{r Coarse Root Density}
#boxplot
shortcore$Depth = factor(shortcore$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = shortcore, aes(x = Depth, y = CoarseRootDensity)) + geom_boxplot() + facet_grid(.~Site) + mytheme +
  theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Coarse~Root~Density))

# mean, sd, se: site x depth
paired.coarseroot.sum <- shortcore %>%
  dplyr::group_by(Site, Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(CoarseRootDensity, na.rm = TRUE),
            sd = sd(CoarseRootDensity, na.rm = TRUE),
            se = ((sd(CoarseRootDensity, na.rm = TRUE))/sqrt(n())))

paired.coarseroot.sum$Depth = factor(paired.coarseroot.sum$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = paired.coarseroot.sum, aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  facet_grid(.~Site) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Coarse~Root~P))

# mean, sd, se: site 
paired.coarseroot.sum2 <- shortcore %>%
  dplyr::group_by(Site) %>%
  dplyr::summarise(n = n(),
            mean = mean(CoarseRootDensity, na.rm = TRUE),
            sd = sd(CoarseRootDensity, na.rm = TRUE),
            se = ((sd(CoarseRootDensity, na.rm = TRUE))/sqrt(n())))

ggplot(data = paired.coarseroot.sum2, aes(x = Site, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Coarse~Root)) +
  theme(axis.title.x = element_blank())

```
```{r Paired Coarse Root ANOVA}

# not normal. variance ok. transform
# rank transformation
paired.rank.coarse <- rank(shortcore$CoarseRootDensity)
shortcore <- cbind(shortcore, paired.rank.coarse)

# model
coarse.aov <- lm(paired.rank.coarse ~ Site + Depth + Site:Depth, data = shortcore)
anova(coarse.aov) # no interaction, test separately 

paired.coarse.site <- aov(paired.rank.coarse ~ Site, data = shortcore)
anova(paired.coarse.site) # site significant

# site Letters
model <- lm(paired.rank.coarse ~ Site, data = shortcore)
coarse.site <- HSD.test(model, "Site", group = TRUE, alpha = 0.05)
print(coarse.site)

paired.coarse.depth <- aov(paired.rank.coarse ~ Depth, data = shortcore)
anova(paired.coarse.depth) # depth is very significant, moreso than site

# depth letters
model <- lm(paired.rank.coarse ~ Depth, data = shortcore)
coarse.depth <- HSD.test(model, "Depth", group = TRUE, alpha = 0.05)
print(coarse.depth)

```

```{r Fine Root Density}
# boxplot
shortcore$Depth = factor(shortcore$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = shortcore, aes(x = Depth, y = FineRootDensity)) + geom_boxplot() + facet_grid(.~Site) + mytheme +
  theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Fine~Root~Density))

# mean, sd, se: site x depth
paired.fineroot.sum <- shortcore %>%
  dplyr::group_by(Site, Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(FineRootDensity, na.rm = TRUE),
            sd = sd(FineRootDensity, na.rm = TRUE),
            se = ((sd(FineRootDensity, na.rm = TRUE))/sqrt(n())))

paired.fineroot.sum$Depth = factor(paired.fineroot.sum$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = paired.fineroot.sum, aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  facet_grid(.~Site) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Fine~Root~P))

# mean, sd, se: site 
paired.fineroot.sum2 <- shortcore %>%
  dplyr::group_by(Site) %>%
  dplyr::summarise(n = n(),
            mean = mean(FineRootDensity, na.rm = TRUE),
            sd = sd(FineRootDensity, na.rm = TRUE),
            se = ((sd(FineRootDensity, na.rm = TRUE))/sqrt(n())))

ggplot(data = paired.fineroot.sum2, aes(x = Site, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Fine~Root)) +
  theme(axis.title.x = element_blank())
```
```{r Paired Fine Root ANOVA}

# not normal. variance ok. transform
# rank transformation
paired.rank.fineroot <- rank(shortcore$FineRootDensity)
shortcore <- cbind(shortcore, paired.rank.fineroot)

# model
fineroot.aov <- lm(paired.rank.fineroot ~ Site + Depth + Site:Depth, data = shortcore)
anova(fineroot.aov) # no interaction, analyze separately

paired.fineroot.site <- aov(paired.rank.fineroot ~ Site, data = shortcore)
anova(paired.fineroot.site) # site not significant

paired.fineroot.depth <- aov(paired.rank.fineroot ~ Depth, data = shortcore)
anova(paired.fineroot.depth) # depth is very significant, moreso than site

# depth letters
model <- lm(paired.rank.fineroot ~ Depth, data = shortcore)
fineroot.depth <- HSD.test(model, "Depth", group = TRUE, alpha = 0.05)
print(fineroot.depth)
```

```{r Root Surface Area}
# boxplot
shortcore$Depth = factor(shortcore$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = shortcore, aes(x = Depth, y = RootSurfaceArea)) + geom_boxplot() + facet_grid(.~Site) + mytheme +
  theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Root~Surface~Area))

# mean, sd, se: site x depth
paired.rootsa.sum <- shortcore %>%
  dplyr::group_by(Site, Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(RootSurfaceArea, na.rm = TRUE),
            sd = sd(RootSurfaceArea, na.rm = TRUE),
            se = ((sd(RootSurfaceArea, na.rm = TRUE))/sqrt(n())))

paired.rootsa.sum$Depth = factor(paired.rootsa.sum$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = paired.rootsa.sum, aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  facet_grid(.~Site) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Root~Surface~Area))

# mean, sd, se: site 
paired.rootsa.sum2 <- shortcore %>%
  dplyr::group_by(Site) %>%
  dplyr::summarise(n = n(),
            mean = mean(RootSurfaceArea, na.rm = TRUE),
            sd = sd(RootSurfaceArea, na.rm = TRUE),
            se = ((sd(RootSurfaceArea, na.rm = TRUE))/sqrt(n())))

ggplot(data = paired.rootsa.sum2, aes(x = Site, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Root~Surface~Area)) +
  theme(axis.title.x = element_blank())
```
```{r Root SA ANOVA}

# normal. variance ok.

# model
rootsa.aov <- lm(RootSurfaceArea ~ Site + Depth + Site:Depth, data = shortcore)
anova(rootsa.aov) # analyze separately no interaction terms

# site
paired.rootsa.site <- aov(RootSurfaceArea ~ Site, data = shortcore)
anova(paired.rootsa.site) # site significant

# Site Letters. Use this for when there is one factor
model <- lm(RootSurfaceArea ~ Site, data = shortcore)
rootsa.site <- HSD.test(model, "Site", group = TRUE, alpha = 0.05)
print(rootsa.site)

# depth
paired.rootsa.depth <- aov(RootSurfaceArea ~ Depth, data = shortcore)
anova(paired.rootsa.depth) # site is more significant than depth in determining surface area...perhaps phosphatase is the same?

# depth letters
model <- lm(RootSurfaceArea ~ Depth, data = shortcore)
rootsa.depth <- HSD.test(model, "Depth", group = TRUE, alpha = 0.05)
print(rootsa.depth)

```

```{r Resin P Paired}
# boxplot
shortcore$Depth = factor(shortcore$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = shortcore, aes(x = Depth, y = ResinP)) + geom_boxplot() + facet_grid(.~Site) + mytheme +
  theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Resin~P))

# mean, sd, se: site x depth
paired.resinp.sum <- shortcore %>%
  dplyr::group_by(Site, Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(ResinP, na.rm = TRUE),
            sd = sd(ResinP, na.rm = TRUE),
            se = ((sd(ResinP, na.rm = TRUE))/sqrt(n())))

paired.resinp.sum$Depth = factor(paired.resinp.sum$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = paired.resinp.sum, aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  facet_grid(.~Site) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Resin~P))

# mean, sd, se: site 
paired.resinp.sum2 <- shortcore %>%
  dplyr::group_by(Site) %>%
  dplyr::summarise(n = n(),
            mean = mean(ResinP, na.rm = TRUE),
            sd = sd(ResinP, na.rm = TRUE),
            se = ((sd(ResinP, na.rm = TRUE))/sqrt(n())))

ggplot(data = paired.resinp.sum2, aes(x = Site, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Resin~P)) +
  theme(axis.title.x = element_blank())
```
```{r Paired ResinP ANOVA}
# not normal. variance ok. transform
# rank transformation
paired.rank.resinp <- rank(shortcore$ResinP)
shortcore <- cbind(shortcore, paired.rank.resinp)

# model
resinp.aov <- lm(paired.rank.resinp ~ Site + Depth + Site:Depth, data = shortcore)
anova(resinp.aov) # only site significant like root surface

# Site Letters
model <- lm(paired.rank.resinp ~ Site, data = shortcore)
resinp.site <- HSD.test(model, "Site", group = TRUE, alpha = 0.05)
print(resinp.site)
```

```{r Total Organic P}
# boxplot
shortcore$Depth = factor(shortcore$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = shortcore, aes(x = Depth, y = Total_OrgP)) + geom_boxplot() + facet_grid(.~Site) + mytheme +
  theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Total~Organic~P))

# mean, sd, se: site x depth
paired.organicp.sum <- shortcore %>%
  dplyr::group_by(Site, Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(Total_OrgP, na.rm = TRUE),
            sd = sd(Total_OrgP, na.rm = TRUE),
            se = ((sd(Total_OrgP, na.rm = TRUE))/sqrt(n())))

paired.organicp.sum$Depth = factor(paired.organicp.sum$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = paired.organicp.sum, aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  facet_grid(.~Site) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Organic~P))

# mean, sd, se: site 
paired.organicp.sum2 <- shortcore %>%
  dplyr::group_by(Site) %>%
  dplyr::summarise(n = n(),
            mean = mean(Total_OrgP, na.rm = TRUE),
            sd = sd(Total_OrgP, na.rm = TRUE),
            se = ((sd(Total_OrgP, na.rm = TRUE))/sqrt(n())))

ggplot(data = paired.organicp.sum2, aes(x = Site, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Organic~P)) +
  theme(axis.title.x = element_blank())
```
```{r Paired Organic P ANOVA}
# not normal. variance ok. transform
# rank transformation
paired.rank.orgp <- rank(shortcore$Total_OrgP)
shortcore <- cbind(shortcore, paired.rank.orgp)

# model
orgp.aov <- lm(paired.rank.orgp ~ Site + Depth + Site:Depth, data = shortcore)
anova(orgp.aov) # interaction not significant, analyze separately

# site
orgp.site <- aov(paired.rank.orgp ~ Site, data = shortcore)
anova(orgp.site) # very significant 

# site letters
model <- lm(paired.rank.orgp ~ Site, data = shortcore)
orgp.site <- HSD.test(model, "Site", group = TRUE, alpha = 0.05)
print(orgp.site)
```

```{r Root Pase g}
# boxplot
shortcore$Depth = factor(shortcore$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = shortcore, aes(x = Depth, y = RootPase_groot)) + geom_boxplot() + facet_grid(.~Site) + mytheme +
  theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Root~Phosphatase))

# mean, sd, se: site x depth
paired.rootpase.sum <- shortcore %>%
  dplyr::group_by(Site, Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(RootPase_groot, na.rm = TRUE),
            sd = sd(RootPase_groot, na.rm = TRUE),
            se = ((sd(RootPase_groot, na.rm = TRUE))/sqrt(n())))

paired.rootpase.sum$Depth = factor(paired.rootpase.sum$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = paired.rootpase.sum, aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  facet_grid(.~Site) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Root~Phosphatase))

# mean, sd, se: site 
paired.rootpase.sum2 <- shortcore %>%
  dplyr::group_by(Site) %>%
  dplyr::summarise(n = n(),
            mean = mean(RootPase_groot, na.rm = TRUE),
            sd = sd(RootPase_groot, na.rm = TRUE),
            se = ((sd(RootPase_groot, na.rm = TRUE))/sqrt(n())))

ggplot(data = paired.rootpase.sum2, aes(x = Site, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Root~Phosphatase)) +
  theme(axis.title.x = element_blank())
```
```{r Root Pase g ANOVA}
# not normal. variance ok. transform
# rank transformation
paired.rank.rootpase <- rank(shortcore$RootPase_groot)
shortcore <- cbind(shortcore, paired.rank.rootpase)

# model
rootpase.aov <- lm(paired.rank.rootpase ~ Site + Depth + Site:Depth, data = shortcore)
anova(rootpase.aov) # only site is significant

# Site Letters. Use this for when there is one factor
model <- lm(paired.rank.rootpase ~ Site, data = shortcore)
rootpase.site <- HSD.test(model, "Site", group = TRUE, alpha = 0.05)
print(rootpase.site)
```

```{r Root Pase vol}
# boxplot
shortcore$Depth = factor(shortcore$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = shortcore, aes(x = Depth, y = RootPase_vol)) + geom_boxplot() + facet_grid(.~Site) + mytheme +
  theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Root~Phosphatase))

# mean, sd, se: site x depth
paired.rootpase.sum <- shortcore %>%
  dplyr::group_by(Site, Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(RootPase_vol, na.rm = TRUE),
            sd = sd(RootPase_vol, na.rm = TRUE),
            se = ((sd(RootPase_vol, na.rm = TRUE))/sqrt(n())))

paired.rootpase.sum$Depth = factor(paired.rootpase.sum$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = paired.rootpase.sum, aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  facet_grid(.~Site) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Root~Phosphatase))

# mean, sd, se: site 
paired.rootpase.sum2 <- shortcore %>%
  dplyr::group_by(Site) %>%
  dplyr::summarise(n = n(),
            mean = mean(RootPase_vol, na.rm = TRUE),
            sd = sd(RootPase_vol, na.rm = TRUE),
            se = ((sd(RootPase_vol, na.rm = TRUE))/sqrt(n())))

ggplot(data = paired.rootpase.sum2, aes(x = Site, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Root~Phosphatase)) +
  theme(axis.title.x = element_blank())
```
```{r Root Pase vol ANOVA}
# not normal. variance ok. transform
# rank transformation
paired.rank.rootpase.vol <- rank(shortcore$RootPase_vol)
shortcore <- cbind(shortcore, paired.rank.rootpase.vol)

# model
rootpase.aov <- lm(paired.rank.rootpase.vol ~ Site + Depth + Site:Depth, data = shortcore)
anova(rootpase.aov) # not significant interaction (p > 0.05). analyze separately

# site
rootpase.site <- lm(paired.rank.rootpase.vol ~ Site, data = shortcore)
anova(rootpase.site)

# Site Letters. Use this for when there is one factor
model <- lm(paired.rank.rootpase.vol ~ Site, data = shortcore)
rootpase.site <- HSD.test(model, "Site", group = TRUE, alpha = 0.05)
print(rootpase.site)

```

```{r Soil Pase g}
# boxplot
shortcore$Depth = factor(shortcore$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = shortcore, aes(x = Depth, y = SoilPase_g)) + geom_boxplot() + facet_grid(.~Site) + mytheme +
  theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Soil~Phosphatase))

# mean, sd, se: site x depth
paired.soilpase.sum <- shortcore %>%
  dplyr::group_by(Site, Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(SoilPase_g, na.rm = TRUE),
            sd = sd(SoilPase_g, na.rm = TRUE),
            se = ((sd(SoilPase_g, na.rm = TRUE))/sqrt(n())))

paired.soilpase.sum$Depth = factor(paired.soilpase.sum$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = paired.soilpase.sum, aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  facet_grid(.~Site) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Soil~Phosphatase))

# mean, sd, se: site 
paired.soilpase.sum2 <- shortcore %>%
  dplyr::group_by(Site) %>%
  dplyr::summarise(n = n(),
            mean = mean(SoilPase_g, na.rm = TRUE),
            sd = sd(SoilPase_g, na.rm = TRUE),
            se = ((sd(SoilPase_g, na.rm = TRUE))/sqrt(n())))

ggplot(data = paired.soilpase.sum2, aes(x = Site, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Soil~Phosphatase)) +
  theme(axis.title.x = element_blank())
```
```{r Paired Soil Pase g ANOVA}
# normal data. variance okay

# model
soilpase.aov <- lm(SoilPase_g ~ Site + Depth + Site:Depth, data = shortcore)
anova(soilpase.aov) # only site is significant

# Site Letters 
model <- lm(SoilPase_g ~ Site, data = shortcore)
soilpase.site <- HSD.test(model, "Site", group = TRUE, alpha = 0.05)
print(soilpase.site)
```

```{r Soil Pase vol}
# boxplot
shortcore$Depth = factor(shortcore$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = shortcore, aes(x = Depth, y = SoilPase_vol)) + geom_boxplot() + facet_grid(.~Site) + mytheme +
  theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Soil~Phosphatase))

# mean, sd, se: site x depth
paired.soilpase.sum <- shortcore %>%
  dplyr::group_by(Site, Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(SoilPase_vol, na.rm = TRUE),
            sd = sd(SoilPase_vol, na.rm = TRUE),
            se = ((sd(SoilPase_vol, na.rm = TRUE))/sqrt(n())))

paired.soilpase.sum$Depth = factor(paired.soilpase.sum$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = paired.soilpase.sum, aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  facet_grid(.~Site) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Soil~Phosphatase))

# mean, sd, se: site 
paired.soilpase.sum2 <- shortcore %>%
  dplyr::group_by(Site) %>%
  dplyr::summarise(n = n(),
            mean = mean(SoilPase_vol, na.rm = TRUE),
            sd = sd(SoilPase_vol, na.rm = TRUE),
            se = ((sd(SoilPase_vol, na.rm = TRUE))/sqrt(n())))

ggplot(data = paired.rootpase.sum2, aes(x = Site, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Soil~Phosphatase)) +
  theme(axis.title.x = element_blank())
```
```{r Paired Soil Pase vol ANOVA}

# not normal. variance ok. transform
# rank transformation
paired.rank.soilpase.vol <- rank(shortcore$SoilPase_vol)
shortcore <- cbind(shortcore, paired.rank.soilpase.vol)

# model
soilpase.aov <- lm(paired.rank.soilpase.vol ~ Site + Depth + Site:Depth, data = shortcore)
anova(soilpase.aov) # only site is significant

# site
model <- lm(paired.rank.soilpase.vol ~ Site, data = shortcore)
soilpase.site <- HSD.test(model, "Site", group = TRUE, alpha = 0.05)
print(soilpase.site)
```

```{r Paired Percent P}
# boxplot
shortcore$Depth = factor(shortcore$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = shortcore, aes(x = Depth, y = PercentP)) + geom_boxplot() + facet_grid(.~Site) + mytheme +
  theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Root~'%'~P))

# mean, sd, se: site x depth
paired.percentp.sum <- shortcore %>%
  dplyr::group_by(Site, Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(PercentP, na.rm = TRUE),
            sd = sd(PercentP, na.rm = TRUE),
            se = ((sd(PercentP, na.rm = TRUE))/sqrt(n())))

paired.percentp.sum$Depth = factor(paired.percentp.sum$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = paired.percentp.sum, aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  facet_grid(.~Site) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Root~'%'~P))

# mean, sd, se: site 
paired.percentp.sum2 <- shortcore %>%
  dplyr::group_by(Site) %>%
  dplyr::summarise(n = n(),
            mean = mean(PercentP, na.rm = TRUE),
            sd = sd(PercentP, na.rm = TRUE),
            se = ((sd(PercentP, na.rm = TRUE))/sqrt(n())))

ggplot(data = paired.percentp.sum2, aes(x = Site, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Root~'%'~P)) +
  theme(axis.title.x = element_blank())

```
```{r Paired Percent P ANOVA}
# model
percentp.aov <- lm(PercentP ~ Site + Depth + Site:Depth, data = shortcore)
anova(percentp.aov) # no interaction term. analyze separately

# site
percentp.site <- aov(PercentP ~ Site, data = shortcore)
anova(percentp.site)

model <- lm(PercentP ~ Site, data = shortcore)
percentp.site <- HSD.test(model, "Site", group = TRUE, alpha = 0.05)
print(percentp.site)

# depth
percentp.depth <- aov(PercentP ~ Depth, data = shortcore)
anova(percentp.depth) # site is more significnat than depth

model <- lm(PercentP ~ Depth, data = shortcore)
percentp.depth <- HSD.test(model, "Depth", group = TRUE, alpha = 0.05)
print(percentp.depth)
```

```{r Paired Bulk Density}
# boxplot
shortcore$Depth = factor(shortcore$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = shortcore, aes(x = Depth, y = BulkDensity)) + geom_boxplot() + facet_grid(.~Site) + mytheme +
  theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Bulk~Density))

# mean, sd, se: site x depth
paired.bulkdens.sum <- shortcore %>%
  dplyr::group_by(Site, Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(BulkDensity, na.rm = TRUE),
            sd = sd(BulkDensity, na.rm = TRUE),
            se = ((sd(BulkDensity, na.rm = TRUE))/sqrt(n())))

paired.bulkdens.sumDepth = factor(paired.bulkdens.sum$Depth, levels = c('0-10', '10-20', '20-30'))
ggplot(data = paired.bulkdens.sum, aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  facet_grid(.~Site) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + theme(axis.text.x = element_text(angle = 30, hjust = 1, vjust = 1)) +
  ylab(expression(Mean~Bulk~Density))

# mean, sd, se: site 
paired.bulkdens.sum2 <- shortcore %>%
  dplyr::group_by(Site) %>%
  dplyr::summarise(n = n(),
            mean = mean(BulkDensity, na.rm = TRUE),
            sd = sd(BulkDensity, na.rm = TRUE),
            se = ((sd(BulkDensity, na.rm = TRUE))/sqrt(n())))

ggplot(data = paired.bulkdens.sum2 , aes(x = Site, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Bulk~Density)) +
  theme(axis.title.x = element_blank())

# mean, sd, se: site - depth
paired.bulkdens.sum3 <- shortcore %>%
  dplyr::group_by(Depth) %>%
  dplyr::summarise(n = n(),
            mean = mean(BulkDensity, na.rm = TRUE),
            sd = sd(BulkDensity, na.rm = TRUE),
            se = ((sd(BulkDensity, na.rm = TRUE))/sqrt(n())))

ggplot(data = paired.bulkdens.sum3 , aes(x = Depth, y = mean)) + 
  geom_bar(stat = "identity", colour = "black", position = position_dodge(0.5)) +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se), position = position_dodge(0.5), width = 0.2) +
  mytheme + 
  ylab(expression(Mean~Bulk~Density)) +
  theme(axis.title.x = element_blank())


```
```{r Paired BD ANOVA}

# normal

bulkdens.aov <- lm(BulkDensity ~ Site + Depth + Site:Depth, data = shortcore)
anova(bulkdens.aov) # only depth is significant

# depth
bulkdens.depth <- aov(BulkDensity ~ Depth, data = shortcore)
anova(bulkdens.depth) 

model <- lm(BulkDensity ~ Depth, data = shortcore)
bulkdens.depth <- HSD.test(model, "Depth", group = TRUE, alpha = 0.05)
print(bulkdens.depth)
```


## Paired MANOVA
```{r}
# rank transforming data
rootpase_vol.rank <- rank(shortcore$RootPase_vol)
soilpase_vol.rank <- rank(shortcore$SoilPase_vol)

# creating dataset
shortcore <- cbind(shortcore, rootpase_vol.rank, soilpase_vol.rank)
shortcore.manova <- shortcore %>% 
  select(Site, Depth, rootpase_vol.rank, soilpase_vol.rank)
shortcore.manova <- melt(shortcore.manova, id = c("Site", "Depth"))
shortcore.manova$ID <- seq.int(nrow(shortcore))

# establishing factors
shortcore.manova  <- within(shortcore.manova , {
  Site <- factor(Site)
  Depth <- factor(Depth)
  variable <- factor(variable)
})

# ANOVA
pairedmanova.aov <- with(shortcore.manova,
               aov(value ~ variable*Site*Depth + Error(ID / (Site*Depth))))
summary(pairedmanova.aov)
```



## Root Phosphatase Correlations
```{r Root Variables}

# Coarse Root x Root Pase
ggplot(data = shortcore, aes(x = CoarseRootDensity, y = RootPase_vol)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme 
# not worth lm

# Fine root x Root Pase - significant 
ggplot(data = shortcore, aes(x = FineRootDensity, y = RootPase_vol)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

# centering
shortcore <- shortcore %>% 
  mutate(c.fineroots = FineRootDensity - mean(shortcore$FineRootDensity, na.rm = TRUE))

ls17 <- lm(RootPase_vol ~ c.fineroots, data = shortcore)
coef(ls17) # centered it
summary(ls17) # eq: y = 0.051 + 0.102x; p < 0.05; r2 = 0.715

# Root surface area - significant
ggplot(data = shortcore, aes(x = RootSurfaceArea, y = RootPase_vol)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme +
  scale_x_continuous(limits = c(0, 50))

ggplot(data = shortcore, aes(x = RootSurfaceArea, y = RootPase_groot)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls18 <- lm(RootPase_groot ~ RootSurfaceArea, data = shortcore)
coef(ls18) 
summary(ls18) # eq: y = 27.793 + 0.896x; p < 0.05; r2 = 0.202

# Root pase x Percent P
ggplot(data = shortcore, aes(x = RootPase_vol, y = PercentP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme +
  scale_x_continuous(limits = c(0, 0.1))

ls19 <- lm(PercentP ~ RootPase_vol, data = shortcore)
coef(ls19) 
summary(ls19) # eq: y = 0.053 - 0.047x; p = 0.218; r2 = 0.047

ggplot(data = shortcore, aes(x = RootPase_groot, y = PercentP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme +
  scale_x_continuous(limits = c(0, 100))

ls19b <- lm(PercentP ~ RootPase_groot, data = shortcore)
coef(ls19b) 
summary(ls19b) # eq: y = 0.058 - 0.0001x; p = 0.124; r2 = 0.072

# root phosphatase x soil phosphatase
ggplot(data = shortcore, aes(x = RootPase_vol, y = SoilPase_vol)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme +
  scale_x_continuous(limits = c(0, 0.15))

ls39 <- lm(SoilPase_vol ~ RootPase_vol, data = shortcore)
coef(ls39) 
summary(ls39) # eq: y = 3.341 + 4.786x; p = 0.306; r2 = 0.034

ggplot(data = shortcore, aes(x = RootPase_groot, y = SoilPase_g)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme +
  scale_x_continuous(limits = c(0, 100))

ls39b <- lm(SoilPase_vol ~ RootPase_vol, data = shortcore)
coef(ls39b) 
summary(ls39b) # eq: y = 3.341 + 4.786x; p = 0.306; r2 = 0.034
```

```{r Soil Variables}

# ResinP x Root Pase ; is resin P by vol or by g? bc will use matching pase
ggplot(data = shortcore, aes(x = RootPase_vol, y = ResinP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme +
  scale_x_continuous(limits = c(0, 0.15))

ls20 <- lm(ResinP ~ RootPase_vol, data = shortcore)
coef(ls20) 
summary(ls20) # eq: y = 6.046 - 11.363x; p = 0.207; r2 = 0.051

ggplot(data = shortcore, aes(x = ResinP, y =  RootPase_groot)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls20b <- lm(RootPase_groot ~ ResinP, data = shortcore)
coef(ls20b) 
summary(ls20b) # eq: y = 67.117 - 1.917x; p = 0.253; r2 = 0.042

# Total_OrgP x Root Pase ; # is organic P by vol or by g?
ggplot(data = shortcore, aes(x = Total_OrgP, y = RootPase_vol)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme +
  scale_y_continuous(limits = c(0, 0.15)) # don't see pattern until remove outliers

ls21 <- lm(RootPase_vol ~Total_OrgP, data = shortcore)
coef(ls21) 
summary(ls21) # eq: y = 0.076 - 0.146x; p = 0.346; r2 = 0.030

ggplot(data = shortcore, aes(x = Total_OrgP, y =  RootPase_groot)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

# Bulk density x Root pase
ggplot(data = shortcore, aes(x = BulkDensity, y = RootPase_vol)) + geom_point()+ 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls22 <- lm(RootPase_vol ~ BulkDensity, data = shortcore)
coef(ls22) 
summary(ls22) # eq: y = 0.134 - 0.106x; p = 0.152; r2 = 0.065

ggplot(data = shortcore, aes(x = BulkDensity, y =  RootPase_groot)) + geom_point() + mytheme

# root phosphatase x soil phosphatase
ggplot(data = shortcore, aes(x = RootPase_vol, y =  SoilPase_vol)) + geom_point() + mytheme

```

## Soil Phosphatase Correlations
```{r Soil Pase x Root Variables}

# Coarse Root x Soil Pase
ggplot(data = shortcore, aes(x = CoarseRootDensity, y = SoilPase_vol)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

# Fine root x SoilPase  
ggplot(data = shortcore, aes(x = FineRootDensity, y = SoilPase_vol)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme 

ls23 <- lm(SoilPase_vol ~ FineRootDensity, data = shortcore)
coef(ls23) 
summary(ls23) # eq: y = 3.269 + 0.359x; p = 0.524; r2 = 0.0128

# Root surface area - significant
ggplot(data = shortcore, aes(x = RootSurfaceArea, y = SoilPase_vol)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls24 <- lm(SoilPase_vol ~ RootSurfaceArea, data = shortcore)
coef(ls24) 
summary(ls24) # eq: y = 2.305 + 0.0417x; p = 0.08; r2 = 0.101 # by g is better than by volume

ggplot(data = shortcore, aes(x = RootSurfaceArea, y = SoilPase_g)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls24b <- lm(SoilPase_g ~ RootSurfaceArea, data = shortcore)
coef(ls24b) 
summary(ls24b) # eq: y = 2.468 + 0.076x; p < 0.05; r2 = 0.225 

# Soil pase x Percent P
ggplot(data = shortcore, aes(x = SoilPase_vol, y = PercentP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls25b <- lm(PercentP ~ SoilPase_vol, data = shortcore)
coef(ls25b) 
summary(ls25b) # eq: y = 0.052 - 0.0003 x; p = 0.834; r2 = 0.001 

ggplot(data = shortcore, aes(x = SoilPase_g, y = PercentP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls25 <- lm(PercentP ~ SoilPase_g, data = shortcore)
coef(ls25) 
summary(ls25) # eq: y = 0.047 + 0.0008 x; p = 0.472; r2 = 0.016 # better
```

```{r Soil Pase x Soil Variables}

# ResinP x Soil Pase
# is resin P by vol or by g? bc will use matching pase
ggplot(data = shortcore, aes(x = SoilPase_vol, y = ResinP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme +
  scale_y_continuous(limits = c(0, 10))

ls40 <- lm(ResinP ~ SoilPase_vol, data = shortcore)
coef(ls40) 
summary(ls40) # eq: y = 6.027 -0.153x; p = 0.658; r2 = 0.0062 


ggplot(data = shortcore, aes(x = ResinP, y =  SoilPase_g)) + geom_point() + mytheme

# Total_OrgP x Soil Pase 
# is organic P by vol or by g?
ggplot(data = shortcore, aes(x = Total_OrgP, y = SoilPase_vol)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme +
  scale_x_continuous(limits = c(0, 0.3))

ls41b <- lm(SoilPase_vol ~ Total_OrgP, data = shortcore)
coef(ls41b) 
summary(ls41b) # eq: y = 3.865 - 2.073x; p = 0.605; r2 = 0.009

ggplot(data = shortcore, aes(x = Total_OrgP, y =  SoilPase_g)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls41 <- lm(SoilPase_g ~ Total_OrgP, data = shortcore)
coef(ls41) 
summary(ls41) # eq: y = 4.597 + 1.285x; p = 0.794; r2 = 0.002


# Bulk density x Soil pase 
ggplot(data = shortcore, aes(x = BulkDensity, y = SoilPase_vol)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls26 <- lm(SoilPase_vol ~ BulkDensity, data = shortcore)
coef(ls26) 
summary(ls26) # eq: y = 0.539 + 3.955x; p < 0.05; r2 = 0.132 # better

ggplot(data = shortcore, aes(x = BulkDensity, y =  SoilPase_g)) + geom_point()  + 
  geom_smooth(method = "lm", colour = "black") + mytheme

```
## Correlations
```{r BD Correlations}

# bulk density x fine root - significant
ggplot(data = shortcore, aes(x = BulkDensity, y = FineRootDensity)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls27 <- lm(FineRootDensity ~ BulkDensity, data = shortcore)
coef(ls27) 
summary(ls27) # eq: y = 2.007 - 1.650x; p < 0.05; r2 = 0.226 # better

# bulk density x root surface area
ggplot(data = shortcore, aes(x = BulkDensity, y = RootSurfaceArea)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls28 <- lm(RootSurfaceArea ~ BulkDensity, data = shortcore)
coef(ls28) 
summary(ls28) # eq: y = 48.131 - 23.884x; p = 0.09; r2 = 0.090 # better

# bulk density x resin p
ggplot(data = shortcore, aes(x = BulkDensity, y = ResinP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls42 <- lm(ResinP ~ BulkDensity, data = shortcore)
coef(ls42) 
summary(ls42) # y = 8.344 - 3.708; p = 0.301, r2 = 0.033

# bulk density x total organic P
ggplot(data = shortcore, aes(x = BulkDensity, y = Total_OrgP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls29 <- lm(Total_OrgP ~ BulkDensity, data = shortcore)
coef(ls29) 
summary(ls29) # eq: y = 0.267 - 0.147x; p = 0.08; r2 = 0.098 

# bulk density x percentP
ggplot(data = shortcore, aes(x = BulkDensity, y = PercentP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls43 <- lm(PercentP ~ BulkDensity, data = shortcore)
coef(ls43) 
summary(ls43) # eq: y = 0.074 - 0.030x; p < 0.05 ; r2 = 0.122
```

```{r Fine Root Correlations}

# Fine root x resin P
ggplot(data = shortcore, aes(x = FineRootDensity, y = ResinP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme +
  scale_x_continuous(limits = c(0, 1.0))

ls36 <- lm(ResinP ~ FineRootDensity, data = shortcore)
coef(ls36) 
summary(ls36) # eq: y = 5.955 - 0.555x; p = 0.607; r2 = 0.008


# fine root x root surface area - significant
ggplot(data = shortcore, aes(x = FineRootDensity, y = RootSurfaceArea)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls30 <- lm(RootSurfaceArea ~ FineRootDensity, data = shortcore)
coef(ls30) 
summary(ls30) # eq: y = 18.495 + 15.310x; p < 0.05; r2 = 0.360 

# fine root x total organic P 
ggplot(data = shortcore, aes(x = FineRootDensity, y = Total_OrgP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls31 <- lm(Total_OrgP ~ FineRootDensity, data = shortcore)
coef(ls31) 
summary(ls31) # eq: y = 0.149 + 0.012x; p = 0.647; r2 = 0.007

# fine root x percentP 
ggplot(data = shortcore, aes(x = FineRootDensity, y = PercentP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls32 <- lm(PercentP ~ FineRootDensity, data = shortcore)
coef(ls32) 
summary(ls32) # eq: y = 0.050 + 0.002x; p = 0.679; r2 = 0.005

# root surface area x resin p
ggplot(data = shortcore, aes(x = RootSurfaceArea, y = ResinP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme +
  scale_x_continuous(limits = c(0, 50))

ls37 <- lm(ResinP ~ RootSurfaceArea, data = shortcore)
coef(ls37) 
summary(ls37) # y = 4.256 + 0.038x; p = 0.416; r2 = 0.022
```

```{r Total Organic P Correlations}

# organic p  x resin P
ggplot(data = shortcore, aes(x = Total_OrgP, y = ResinP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls33 <- lm(ResinP ~ Total_OrgP, data = shortcore)
coef(ls33) 
summary(ls33) # eq: y = 0.698 + 31.483x; p < 0.05; r2 = 0.423

# organic p  x root surface area
ggplot(data = shortcore, aes(x = Total_OrgP, y = RootSurfaceArea)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme +
  scale_x_continuous(limits = c(0.05, 0.25))

ls38 <- lm(RootSurfaceArea ~ Total_OrgP, data = shortcore)
coef(ls38) 
summary(ls38) # eq: y = 28.279 + 15.311x; p = 0.616; r2 = 0.009

#  organic p  x percentP - significant 
ggplot(data = shortcore, aes(x = Total_OrgP, y = PercentP)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme

ls34 <- lm(PercentP ~ Total_OrgP, data = shortcore)
coef(ls34) 
summary(ls34) # eq: y = 0.026 + 0.154x; p < 0.05; r2 = 0.727

# organic p x fine root density 
ggplot(data = shortcore, aes(x = Total_OrgP, y = FineRootDensity)) + geom_point() + 
  geom_smooth(method = "lm", colour = "black") + mytheme +
  scale_y_continuous(limits = c(0, 1.5))

ls37 <- lm(FineRootDensity ~ Total_OrgP, data = shortcore)
coef(ls37) 
summary(ls37) # eq: y = 0.639 + 0.590x; p = 0.647; r2 = 0.007
```